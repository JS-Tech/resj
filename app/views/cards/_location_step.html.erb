<%= javascript_include_tag "https://maps.googleapis.com/maps/api/js?key=AIzaSyDNsGj5h-WJXPiLtYVn0TSfiisPwhEAbjg&sensor=false" %>
<%= render layout: 'form' do |f| %>

	<div class="block">
		<div class="label">
			<p>
				<span class="num">3</span> Quelle est votre <span class="b">rue</span>?
			</p>
		</div>
		<!-- 	<%= f.label :street %> -->
		<%= f.text_field :street %>
	</div>

	<div class="block">
		<div class="label">
			<p><span class="num">4</span> Le <span class="b">npa</span> de votre localité</p>
		</div>
		<!-- 	<%= f.label :npa %> -->
		<%= f.number_field :npa %>
	</div>
	
	<div class="block">
		<div class="label">
			<p><span class="num">5</span> Dans quelle <span class="b">ville</span> êtes-vous?</p>
		</div>
		<!-- 	<%= f.label :city %> -->
		<%= f.text_field :city %>
	</div>

	<div class="block">
		<div class="label">
			<p><span class="num">6</span> Où est votre <span class="b">lieu</span> de rencontre? (à l'église, dans la rue, en face de la garre)</p>
		</div>
		<!-- 	<%= f.label :place %> -->
		<%= f.text_field :place %>
	</div>

	<div class="clear"></div>	

	<!-- 	<%= f.label :latitude %> -->
	<%= f.text_field :latitude, id: "lat", type: :hidden %>

	<!-- 	<%= f.label :longitude %> -->
	<%= f.text_field :longitude, id: "lng", type: :hidden %>

	<div class="block">
		<div class="label">
			<p><span class="num">7</span> Sur une carte, quelle est votre <span class="b">emplacement</span>? Positionnez le curseur en cliquant sur la carte au bon endroit </p>
		</div>
		<div id="map-canvas"></div>	
	</div>

<% end %>

<script type="text/javascript">
  function initialize() {
  	var latlng = new google.maps.LatLng(46.57, 6.8794);
    document.getElementById("lat").value =  latlng.lat();
    document.getElementById("lng").value =  latlng.lng();
    var mapOptions = {
      center: latlng,
      zoom: 8,
      mapTypeId: google.maps.MapTypeId.HYBRID
    };
    var map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);
    geocoder = new google.maps.Geocoder();
    marker = new google.maps.Marker({position: latlng,map: map});
    google.maps.event.addListener(map, 'click', function(event) {
      marker.setPosition(event.latLng);
      var coord = event.latLng;
      document.getElementById("lat").value =  coord.lat();
      document.getElementById("lng").value =  coord.lng();
    });
  }
  google.maps.event.addDomListener(window, 'load', initialize);
</script>
<script type="text/javascript">window.onload=initialize();</script>